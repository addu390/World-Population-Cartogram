var t=Math.PI/3,e=[0,t,2*t,3*t,4*t,5*t];function n(t){return t[0]}function o(t){return t[1]}let r=["#1abc9c","#2ecc71","#3498db","#9b59b6","#34495e","#16a085","#27ae60","#2980b9","#8e44ad","#2c3e50","#f1c40f","#e67e22","#e74c3c","#ecf0f1","#95a5a6","#f39c12","#d35400","#c0392b","#bdc3c7","#7f8c8d"],l=document.querySelector("input#error");function a(){let a=l.value;const f=d3.json("https://raw.githubusercontent.com/addu390/population-cartogram/master/data/population/2018/geo.json");Promise.all([f]).then((l=>{let[f]=l;!function(l,a){const f={top:30,right:30,bottom:30,left:30},d=1250-f.left-f.right,h=750-f.top-f.bottom;let p=1.5*a,y=d/p,m=d3.geoNaturalEarth1().fitExtent([[0,.05*h],[d,.95*h]],l),g=Math.ceil(h/p),v=d3.range(g*y).map((function(t,e){return{x:Math.floor(e%y)*p,y:Math.floor(e/y)*p,datapoint:0}})),x=[];for(let t=0;t<l.features.length;t++)if(x[t]=[],"MultiPolygon"==l.features[t].geometry.type)for(let e=0;e<l.features[t].geometry.coordinates.length;e++)x[t]=x[t].concat(l.features[t].geometry.coordinates[e][0]);else"Polygon"==l.features[t].geometry.type&&(x[t]=x[t].concat(l.features[t].geometry.coordinates[0]));d3.select("#container").selectAll("*").remove();let b=function(){var r,l,a,s=0,u=0,i=1,c=1,f=n,d=o;function h(t){var e,n={},o=[],r=t.length;for(e=0;e<r;++e)if(!isNaN(u=+f.call(null,s=t[e],e,t))&&!isNaN(i=+d.call(null,s,e,t))){var s,u,i,c=Math.round(i/=a),h=Math.round(u=u/l-(1&c)/2),p=i-c;if(3*Math.abs(p)>1){var y=u-h,m=h+(u<h?-1:1)/2,g=c+(i<c?-1:1),v=u-m,x=i-g;y*y+p*p>v*v+x*x&&(h=m+(1&c?1:-1)/2,c=g)}var b=h+"-"+c,M=n[b];M?M.push(s):(o.push(M=n[b]=[s]),M.x=(h+(1&c)/2)*l,M.y=c*a)}return o}function p(t){var n=0,o=0;return e.map((function(e){var r=Math.sin(e)*t,l=-Math.cos(e)*t,a=r-n,s=l-o;return n=r,o=l,[a,s]}))}return h.hexagon=function(t){return"m"+p(null==t?r:+t).join("l")+"z"},h.centers=function(){for(var t=[],e=Math.round(u/a),n=Math.round(s/l),o=e*a;o<c+r;o+=a,++e)for(var f=n*l+(1&e)*l/2;f<i+l/2;f+=l)t.push([f,o]);return t},h.mesh=function(){var t=p(r).slice(0,4).join("l");return h.centers().map((function(e){return"M"+e+"m"+t})).join("")},h.x=function(t){return arguments.length?(f=t,h):f},h.y=function(t){return arguments.length?(d=t,h):d},h.radius=function(e){return arguments.length?(l=2*(r=+e)*Math.sin(t),a=1.5*r,h):r},h.size=function(t){return arguments.length?(s=u=0,i=+t[0],c=+t[1],h):[i-s,c-u]},h.extent=function(t){return arguments.length?(s=+t[0][0],u=+t[0][1],i=+t[1][0],c=+t[1][1],h):[[s,u],[i,c]]},h.radius(1)}().radius(a).x((function(t){return t.x})).y((function(t){return t.y}));const M=d3.select("#container").append("svg").attr("width",d+f.left+f.top).attr("height",h+f.top+f.bottom).append("g").attr("transform",`translate(${f.left} ${f.top})`);M.append("g").attr("id","hexes").selectAll(".hex").data(b(v)).enter().append("path").attr("class","hex").attr("transform",(function(t){return"translate("+t.x+", "+t.y+")"})).attr("d",b.hexagon()).style("fill","#fff").style("stroke","#e0e0e0").style("stroke-width",1).on("click",u);for(let t=0;t<x.length;t++){let e=x[t].map((t=>m(t))),n=b(v.reduce((function(t,n){return d3.polygonContains(e,[n.x,n.y])&&t.push(n),t}),[]));M.append("g").attr("id","hexes").selectAll(".hex").data(n).enter().append("path").attr("class","hex").attr("transform",(function(t){return"translate("+t.x+", "+t.y+")"})).attr("d",b.hexagon()).style("fill",r[t%19]).style("stroke","#000").style("stroke-width",1).on("click",i).on("mouseover",s).on("mouseout",c)}}(f,a)}))}function s(t){d3.select(this).transition().duration(10).style("fill-opacity",.9)}function u(t){if("Remove"==document.querySelector("#label-option").value)d3.select(this).style("fill","#fff").style("stroke","#e0e0e0").lower();else{let t=document.querySelector("#color-option");d3.select(this).style("stroke-width",1).style("fill",t.value).style("stroke","#000").on("mouseover",s).on("mouseout",c).raise()}}function i(t){if("Remove"==document.querySelector("#label-option").value)d3.select(this).remove();else{let t=document.querySelector("#color-option");d3.select(this).style("stroke-width",1).style("fill",t.value).style("stroke","#000").on("mouseover",s).on("mouseout",c).raise()}}function c(t){d3.select(this).transition().duration(10).style("fill-opacity",1)}l.addEventListener("click",(()=>{console.log(l.value),a()})),a();
//# sourceMappingURL=index.4956d4b4.js.map
