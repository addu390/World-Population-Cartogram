var t=Math.PI/3,e=[0,t,2*t,3*t,4*t,5*t];function n(t){return t[0]}function r(t){return t[1]}let o=document.querySelector("input#error");function a(){let a=o.value;const i=d3.json("https://raw.githubusercontent.com/addu390/population-cartogram/master/data/population/2018/geo.json");Promise.all([i]).then((o=>{let[i]=o;!function(o,a){const i={top:30,right:30,bottom:30,left:30},c=1250-i.left-i.right,s=750-i.top-i.bottom;let f=1.5*a,h=c/f,d=d3.geoNaturalEarth1().fitExtent([[0,.05*s],[c,.95*s]],o),p=Math.ceil(s/f),g=d3.range(p*h).map((function(t,e){return{x:Math.floor(e%h)*f,y:Math.floor(e/h)*f,datapoint:0}})),y=[];for(let t=0;t<o.features.length;t++)if(y[t]=[],"MultiPolygon"==o.features[t].geometry.type)for(let e=0;e<o.features[t].geometry.coordinates.length;e++)y[t]=y[t].concat(o.features[t].geometry.coordinates[e][0]);else"Polygon"==o.features[t].geometry.type&&(y[t]=y[t].concat(o.features[t].geometry.coordinates[0]));d3.select("#container").selectAll("*").remove();let m=function(){var o,a,l,u=0,i=0,c=1,s=1,f=n,h=r;function d(t){var e,n={},r=[],o=t.length;for(e=0;e<o;++e)if(!isNaN(i=+f.call(null,u=t[e],e,t))&&!isNaN(c=+h.call(null,u,e,t))){var u,i,c,s=Math.round(c/=l),d=Math.round(i=i/a-(1&s)/2),p=c-s;if(3*Math.abs(p)>1){var g=i-d,y=d+(i<d?-1:1)/2,m=s+(c<s?-1:1),x=i-y,v=c-m;g*g+p*p>x*x+v*v&&(d=y+(1&s?1:-1)/2,s=m)}var M=d+"-"+s,b=n[M];b?b.push(u):(r.push(b=n[M]=[u]),b.x=(d+(1&s)/2)*a,b.y=s*l)}return r}function p(t){var n=0,r=0;return e.map((function(e){var o=Math.sin(e)*t,a=-Math.cos(e)*t,l=o-n,u=a-r;return n=o,r=a,[l,u]}))}return d.hexagon=function(t){return"m"+p(null==t?o:+t).join("l")+"z"},d.centers=function(){for(var t=[],e=Math.round(i/l),n=Math.round(u/a),r=e*l;r<s+o;r+=l,++e)for(var f=n*a+(1&e)*a/2;f<c+a/2;f+=a)t.push([f,r]);return t},d.mesh=function(){var t=p(o).slice(0,4).join("l");return d.centers().map((function(e){return"M"+e+"m"+t})).join("")},d.x=function(t){return arguments.length?(f=t,d):f},d.y=function(t){return arguments.length?(h=t,d):h},d.radius=function(e){return arguments.length?(a=2*(o=+e)*Math.sin(t),l=1.5*o,d):o},d.size=function(t){return arguments.length?(u=i=0,c=+t[0],s=+t[1],d):[c-u,s-i]},d.extent=function(t){return arguments.length?(u=+t[0][0],i=+t[0][1],c=+t[1][0],s=+t[1][1],d):[[u,i],[c,s]]},d.radius(1)}().radius(a).x((function(t){return t.x})).y((function(t){return t.y}));const x=d3.select("#container").append("svg").attr("width",c+i.left+i.top).attr("height",s+i.top+i.bottom).append("g").attr("transform",`translate(${i.left} ${i.top})`);x.append("g").attr("id","hexes").selectAll(".hex").data(m(g)).enter().append("path").attr("class","hex").attr("transform",(function(t){return"translate("+t.x+", "+t.y+")"})).attr("d",m.hexagon()).style("fill","#fff").style("stroke","#e0e0e0").style("stroke-width",1);let v=["#1abc9c","#2ecc71","#3498db","#9b59b6","#34495e","#16a085","#27ae60","#2980b9","#8e44ad","#2c3e50","#f1c40f","#e67e22","#e74c3c","#ecf0f1","#95a5a6","#f39c12","#d35400","#c0392b","#bdc3c7","#7f8c8d"];for(let t=0;t<y.length;t++){let e=y[t].map((t=>d(t))),n=m(g.reduce((function(t,n){return d3.polygonContains(e,[n.x,n.y])&&t.push(n),t}),[]));x.append("g").attr("id","hexes").selectAll(".hex").data(n).enter().append("path").attr("class","hex").attr("transform",(function(t){return"translate("+t.x+", "+t.y+")"})).attr("d",m.hexagon()).style("fill",v[t%19]).style("stroke","#000").style("stroke-width",1).on("mouseover",l).on("mouseout",u)}}(i,a)}))}function l(t){d3.select(this).transition().duration(10).style("fill-opacity",.6)}function u(t){d3.select(this).transition().duration(1e3).style("fill-opacity",1)}o.addEventListener("click",(()=>{console.log(o.value),a()})),a();
//# sourceMappingURL=index.e268e7eb.js.map
