var t=Math.PI/3,e=[0,t,2*t,3*t,4*t,5*t];function n(t){return t[0]}function r(t){return t[1]}let o=["#1abc9c","#2ecc71","#3498db","#9b59b6","#34495e","#16a085","#27ae60","#2980b9","#8e44ad","#2c3e50","#f1c40f","#e67e22","#e74c3c","#ecf0f1","#95a5a6","#f39c12","#d35400","#c0392b","#bdc3c7","#7f8c8d"],a=document.querySelector("input#error");function l(){let l=a.value;const s=d3.json("https://raw.githubusercontent.com/addu390/population-cartogram/master/data/population/2018/geo.json");Promise.all([s]).then((a=>{let[s]=a;!function(a,l){const s={top:30,right:30,bottom:30,left:30},f=1250-s.left-s.right,d=750-s.top-s.bottom;let h=1.5*l,p=f/h,y=d3.geoNaturalEarth1().fitExtent([[0,.05*d],[f,.95*d]],a),g=Math.ceil(d/h),m=d3.range(g*p).map((function(t,e){return{x:Math.floor(e%p)*h,y:Math.floor(e/p)*h,datapoint:0}})),v=[];for(let t=0;t<a.features.length;t++)if(v[t]=[],"MultiPolygon"==a.features[t].geometry.type)for(let e=0;e<a.features[t].geometry.coordinates.length;e++)v[t]=v[t].concat(a.features[t].geometry.coordinates[e][0]);else"Polygon"==a.features[t].geometry.type&&(v[t]=v[t].concat(a.features[t].geometry.coordinates[0]));d3.select("#container").selectAll("*").remove();let x=function(){var o,a,l,u=0,c=0,i=1,s=1,f=n,d=r;function h(t){var e,n={},r=[],o=t.length;for(e=0;e<o;++e)if(!isNaN(c=+f.call(null,u=t[e],e,t))&&!isNaN(i=+d.call(null,u,e,t))){var u,c,i,s=Math.round(i/=l),h=Math.round(c=c/a-(1&s)/2),p=i-s;if(3*Math.abs(p)>1){var y=c-h,g=h+(c<h?-1:1)/2,m=s+(i<s?-1:1),v=c-g,x=i-m;y*y+p*p>v*v+x*x&&(h=g+(1&s?1:-1)/2,s=m)}var M=h+"-"+s,b=n[M];b?b.push(u):(r.push(b=n[M]=[u]),b.x=(h+(1&s)/2)*a,b.y=s*l)}return r}function p(t){var n=0,r=0;return e.map((function(e){var o=Math.sin(e)*t,a=-Math.cos(e)*t,l=o-n,u=a-r;return n=o,r=a,[l,u]}))}return h.hexagon=function(t){return"m"+p(null==t?o:+t).join("l")+"z"},h.centers=function(){for(var t=[],e=Math.round(c/l),n=Math.round(u/a),r=e*l;r<s+o;r+=l,++e)for(var f=n*a+(1&e)*a/2;f<i+a/2;f+=a)t.push([f,r]);return t},h.mesh=function(){var t=p(o).slice(0,4).join("l");return h.centers().map((function(e){return"M"+e+"m"+t})).join("")},h.x=function(t){return arguments.length?(f=t,h):f},h.y=function(t){return arguments.length?(d=t,h):d},h.radius=function(e){return arguments.length?(a=2*(o=+e)*Math.sin(t),l=1.5*o,h):o},h.size=function(t){return arguments.length?(u=c=0,i=+t[0],s=+t[1],h):[i-u,s-c]},h.extent=function(t){return arguments.length?(u=+t[0][0],c=+t[0][1],i=+t[1][0],s=+t[1][1],h):[[u,c],[i,s]]},h.radius(1)}().radius(l).x((function(t){return t.x})).y((function(t){return t.y}));const M=d3.select("#container").append("svg").attr("width",f+s.left+s.top).attr("height",d+s.top+s.bottom).append("g").attr("transform",`translate(${s.left} ${s.top})`);M.append("g").attr("id","hexes").selectAll(".hex").data(x(m)).enter().append("path").attr("class","hex").attr("transform",(function(t){return"translate("+t.x+", "+t.y+")"})).attr("d",x.hexagon()).style("fill","#fff").style("stroke","#e0e0e0").style("stroke-width",1).on("click",c);for(let t=0;t<v.length;t++){let e=v[t].map((t=>y(t))),n=x(m.reduce((function(t,n){return d3.polygonContains(e,[n.x,n.y])&&t.push(n),t}),[]));M.append("g").attr("id","hexes").selectAll(".hex").data(n).enter().append("path").attr("class","hex").attr("transform",(function(t){return"translate("+t.x+", "+t.y+")"})).attr("d",x.hexagon()).style("fill",o[t%19]).style("stroke","#000").style("stroke-width",1).on("click",c).on("mouseover",u).on("mouseout",i)}}(s,l)}))}function u(t){d3.select(this).transition().duration(10).style("fill-opacity",.9)}function c(t){if("Remove"==document.querySelector("#label-option").value)d3.select(this).remove();else{let t=document.querySelector("#color-option");d3.select(this).style("stroke-width",1).style("fill",t.value).style("stroke","#000")}}function i(t){d3.select(this).transition().duration(10).style("fill-opacity",1)}a.addEventListener("click",(()=>{console.log(a.value),l()})),l();
//# sourceMappingURL=index.7989a4f7.js.map
