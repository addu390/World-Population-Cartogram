var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t=Math.PI/3,e=[0,t,2*t,3*t,4*t,5*t];function r(n){return n[0]}function i(n){return n[1]}var o={};!function(t){function e(n,t){return n<t?-1:n>t?1:n>=t?0:NaN}function r(n){return 1===n.length&&(n=i(n)),{left:function(t,e,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){var o=r+i>>>1;n(t[o],e)<0?r=o+1:i=o}return r},right:function(t,e,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){var o=r+i>>>1;n(t[o],e)>0?i=o:r=o+1}return r}}}function i(n){return function(t,r){return e(n(t),r)}}function o(n){for(var t,e,r,i=n.length,o=-1,u=0;++o<i;)u+=n[o].length;for(e=new Array(u);--i>=0;)for(t=(r=n[i]).length;--t>=0;)e[--u]=r[t];return e}function u(n,t){var e,r=0,i=n.length,o=-1;if(null==t)for(;++o<i;)(e=+n[o])&&(r+=e);else for(;++o<i;)(e=+t(n[o],o,n))&&(r+=e);return r}function a(){return new l}function l(){this.reset()}r(e),l.prototype={constructor:l,reset:function(){this.s=this.t=0},add:function(n){f(c,n,this.t),f(this,c.s,this.s),this.s?this.t+=c.t:this.s=c.t},valueOf:function(){return this.s}};var c=new l;function f(n,t,e){var r=n.s=t+e,i=r-t,o=r-i;n.t=t-o+(e-i)}var s=1e-6,p=Math.PI,h=p/2,d=p/4,v=2*p,g=180/p,y=p/180,m=Math.abs,S=Math.atan,E=Math.atan2,x=Math.cos,M=Math.sin,b=Math.sign||function(n){return n>0?1:n<0?-1:0},w=Math.sqrt;function _(n){return n>1?0:n<-1?p:Math.acos(n)}function N(n){return n>1?h:n<-1?-h:Math.asin(n)}function k(){}function q(n,t){n&&P.hasOwnProperty(n.type)&&P[n.type](n,t)}var j={Feature:function(n,t){q(n.geometry,t)},FeatureCollection:function(n,t){for(var e=n.features,r=-1,i=e.length;++r<i;)q(e[r].geometry,t)}},P={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates,t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var e=n.coordinates,r=-1,i=e.length;++r<i;)n=e[r],t.point(n[0],n[1],n[2])},LineString:function(n,t){L(n.coordinates,t,0)},MultiLineString:function(n,t){for(var e=n.coordinates,r=-1,i=e.length;++r<i;)L(e[r],t,0)},Polygon:function(n,t){A(n.coordinates,t)},MultiPolygon:function(n,t){for(var e=n.coordinates,r=-1,i=e.length;++r<i;)A(e[r],t)},GeometryCollection:function(n,t){for(var e=n.geometries,r=-1,i=e.length;++r<i;)q(e[r],t)}};function L(n,t,e){var r,i=-1,o=n.length-e;for(t.lineStart();++i<o;)r=n[i],t.point(r[0],r[1],r[2]);t.lineEnd()}function A(n,t){var e=-1,r=n.length;for(t.polygonStart();++e<r;)L(n[e],t,1);t.polygonEnd()}function z(n,t){n&&j.hasOwnProperty(n.type)?j[n.type](n,t):q(n,t)}function C(n){return[E(n[1],n[0]),N(n[2])]}function F(n){var t=n[0],e=n[1],r=x(e);return[r*x(t),r*M(t),M(e)]}function O(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function R(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function G(n,t){n[0]+=t[0],n[1]+=t[1],n[2]+=t[2]}function T(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function I(n){var t=w(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t,n[1]/=t,n[2]/=t}function $(n,t){function e(e,r){return e=n(e,r),t(e[0],e[1])}return n.invert&&t.invert&&(e.invert=function(e,r){return(e=t.invert(e,r))&&n.invert(e[0],e[1])}),e}function Z(n,t){return[n>p?n-v:n<-p?n+v:n,t]}function B(n,t,e){return(n%=v)?t||e?$(H(n),J(t,e)):H(n):t||e?J(t,e):Z}function D(n){return function(t,e){return[(t+=n)>p?t-v:t<-p?t+v:t,e]}}function H(n){var t=D(n);return t.invert=D(-n),t}function J(n,t){var e=x(n),r=M(n),i=x(t),o=M(t);function u(n,t){var u=x(t),a=x(n)*u,l=M(n)*u,c=M(t),f=c*e+a*r;return[E(l*i-f*o,a*e-c*r),N(f*i+l*o)]}return u.invert=function(n,t){var u=x(t),a=x(n)*u,l=M(n)*u,c=M(t),f=c*i-l*o;return[E(l*i+c*o,a*e+f*r),N(f*e-a*r)]},u}function K(n,t,e,r,i,o){if(e){var u=x(t),a=M(t),l=r*e;null==i?(i=t+r*v,o=t-l/2):(i=Q(u,i),o=Q(u,o),(r>0?i<o:i>o)&&(i+=r*v));for(var c,f=i;r>0?f>o:f<o;f-=l)c=C([u,-a*x(f),-a*M(f)]),n.point(c[0],c[1])}}function Q(n,t){(t=F(t))[0]-=n,I(t);var e=_(-t[1]);return((-t[2]<0?-e:e)+v-s)%v}function U(){var n,t=[];return{point:function(t,e){n.push([t,e])},lineStart:function(){t.push(n=[])},lineEnd:k,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var e=t;return t=[],n=null,e}}}function V(n,t,e,r,i,o){var u,a=n[0],l=n[1],c=0,f=1,s=t[0]-a,p=t[1]-l;if(u=e-a,s||!(u>0)){if(u/=s,s<0){if(u<c)return;u<f&&(f=u)}else if(s>0){if(u>f)return;u>c&&(c=u)}if(u=i-a,s||!(u<0)){if(u/=s,s<0){if(u>f)return;u>c&&(c=u)}else if(s>0){if(u<c)return;u<f&&(f=u)}if(u=r-l,p||!(u>0)){if(u/=p,p<0){if(u<c)return;u<f&&(f=u)}else if(p>0){if(u>f)return;u>c&&(c=u)}if(u=o-l,p||!(u<0)){if(u/=p,p<0){if(u>f)return;u>c&&(c=u)}else if(p>0){if(u<c)return;u<f&&(f=u)}return c>0&&(n[0]=a+c*s,n[1]=l+c*p),f<1&&(t[0]=a+f*s,t[1]=l+f*p),!0}}}}}function W(n,t){return m(n[0]-t[0])<s&&m(n[1]-t[1])<s}function X(n,t,e,r){this.x=n,this.z=t,this.o=e,this.e=r,this.v=!1,this.n=this.p=null}function Y(n,t,e,r,i){var o,u,a=[],l=[];if(n.forEach((function(n){if(!((t=n.length-1)<=0)){var t,e,r=n[0],u=n[t];if(W(r,u)){for(i.lineStart(),o=0;o<t;++o)i.point((r=n[o])[0],r[1]);i.lineEnd()}else a.push(e=new X(r,n,null,!0)),l.push(e.o=new X(r,null,e,!1)),a.push(e=new X(u,n,null,!1)),l.push(e.o=new X(u,null,e,!0))}})),a.length){for(l.sort(t),nn(a),nn(l),o=0,u=l.length;o<u;++o)l[o].e=e=!e;for(var c,f,s=a[0];;){for(var p=s,h=!0;p.v;)if((p=p.n)===s)return;c=p.z,i.lineStart();do{if(p.v=p.o.v=!0,p.e){if(h)for(o=0,u=c.length;o<u;++o)i.point((f=c[o])[0],f[1]);else r(p.x,p.n.x,1,i);p=p.n}else{if(h)for(c=p.p.z,o=c.length-1;o>=0;--o)i.point((f=c[o])[0],f[1]);else r(p.x,p.p.x,-1,i);p=p.p}c=(p=p.o).z,h=!h}while(!p.v);i.lineEnd()}}}function nn(n){if(t=n.length){for(var t,e,r=0,i=n[0];++r<t;)i.n=e=n[r],e.p=i,i=e;i.n=e=n[0],e.p=i}}a(),a(),a(),Z.invert=Z;var tn=1e9,en=-tn;function rn(n,t,e,r){function i(i,o){return n<=i&&i<=e&&t<=o&&o<=r}function u(i,o,u,l){var f=0,s=0;if(null==i||(f=a(i,u))!==(s=a(o,u))||c(i,o)<0^u>0)do{l.point(0===f||3===f?n:e,f>1?r:t)}while((f=(f+u+4)%4)!==s);else l.point(o[0],o[1])}function a(r,i){return m(r[0]-n)<s?i>0?0:3:m(r[0]-e)<s?i>0?2:1:m(r[1]-t)<s?i>0?1:0:i>0?3:2}function l(n,t){return c(n.x,t.x)}function c(n,t){var e=a(n,1),r=a(t,1);return e!==r?e-r:0===e?t[1]-n[1]:1===e?n[0]-t[0]:2===e?n[1]-t[1]:t[0]-n[0]}return function(a){var c,f,s,p,h,d,v,g,y,m,S,E=a,x=U(),M={point:b,lineStart:k,lineEnd:q,polygonStart:_,polygonEnd:N};function b(n,t){i(n,t)&&E.point(n,t)}function w(){for(var t=0,e=0,i=f.length;e<i;++e)for(var o,u,a=f[e],l=1,c=a.length,s=a[0],p=s[0],h=s[1];l<c;++l)o=p,u=h,p=(s=a[l])[0],h=s[1],u<=r?h>r&&(p-o)*(r-u)>(h-u)*(n-o)&&++t:h<=r&&(p-o)*(r-u)<(h-u)*(n-o)&&--t;return t}function _(){E=x,c=[],f=[],S=!0}function N(){var n=w(),t=S&&n,e=(c=o(c)).length;(t||e)&&(a.polygonStart(),t&&(a.lineStart(),u(null,null,1,a),a.lineEnd()),e&&Y(c,l,n,u,a),a.polygonEnd()),E=a,c=f=s=null}function k(){M.point=j,f&&f.push(s=[]),m=!0,y=!1,v=g=NaN}function q(){c&&(j(p,h),d&&y&&x.rejoin(),c.push(x.result())),M.point=b,y&&E.lineEnd()}function j(o,u){var a=i(o,u);if(f&&s.push([o,u]),m)p=o,h=u,d=a,m=!1,a&&(E.lineStart(),E.point(o,u));else if(a&&y)E.point(o,u);else{var l=[v=Math.max(en,Math.min(tn,v)),g=Math.max(en,Math.min(tn,g))],c=[o=Math.max(en,Math.min(tn,o)),u=Math.max(en,Math.min(tn,u))];V(l,c,n,t,e,r)?(y||(E.lineStart(),E.point(l[0],l[1])),E.point(c[0],c[1]),a||E.lineEnd(),S=!1):a&&(E.lineStart(),E.point(o,u),S=!1)}v=o,g=u,y=a}return M}}var on=a();function un(n,t){var e=t[0],r=t[1],i=[M(e),-x(e),0],o=0,u=0;on.reset();for(var a=0,l=n.length;a<l;++a)if(f=(c=n[a]).length)for(var c,f,h=c[f-1],g=h[0],y=h[1]/2+d,m=M(y),S=x(y),b=0;b<f;++b,g=_,m=q,S=j,h=w){var w=c[b],_=w[0],k=w[1]/2+d,q=M(k),j=x(k),P=_-g,L=P>=0?1:-1,A=L*P,z=A>p,C=m*q;if(on.add(E(C*L*M(A),S*j+C*x(A))),o+=z?P+L*v:P,z^g>=e^_>=e){var O=R(F(h),F(w));I(O);var G=R(i,O);I(G);var T=(z^P>=0?-1:1)*N(G[2]);(r>T||r===T&&(O[0]||O[1]))&&(u+=z^P>=0?1:-1)}}return(o<-s||o<s&&on<-s)^1&u}function an(n){return n}a();var ln,cn,fn,sn,pn=a(),hn=a(),dn={point:k,lineStart:k,lineEnd:k,polygonStart:function(){dn.lineStart=vn,dn.lineEnd=mn},polygonEnd:function(){dn.lineStart=dn.lineEnd=dn.point=k,pn.add(m(hn)),hn.reset()},result:function(){var n=pn/2;return pn.reset(),n}};function vn(){dn.point=gn}function gn(n,t){dn.point=yn,ln=fn=n,cn=sn=t}function yn(n,t){hn.add(sn*n-fn*t),fn=n,sn=t}function mn(){yn(ln,cn)}var Sn=1/0,En=Sn,xn=-Sn,Mn=xn,bn={point:wn,lineStart:k,lineEnd:k,polygonStart:k,polygonEnd:k,result:function(){var n=[[Sn,En],[xn,Mn]];return xn=Mn=-(En=Sn=1/0),n}};function wn(n,t){n<Sn&&(Sn=n),n>xn&&(xn=n),t<En&&(En=t),t>Mn&&(Mn=t)}var _n,Nn,kn,qn,jn=0,Pn=0,Ln=0,An=0,zn=0,Cn=0,Fn=0,On=0,Rn=0,Gn={point:Tn,lineStart:In,lineEnd:Bn,polygonStart:function(){Gn.lineStart=Dn,Gn.lineEnd=Hn},polygonEnd:function(){Gn.point=Tn,Gn.lineStart=In,Gn.lineEnd=Bn},result:function(){var n=Rn?[Fn/Rn,On/Rn]:Cn?[An/Cn,zn/Cn]:Ln?[jn/Ln,Pn/Ln]:[NaN,NaN];return jn=Pn=Ln=An=zn=Cn=Fn=On=Rn=0,n}};function Tn(n,t){jn+=n,Pn+=t,++Ln}function In(){Gn.point=$n}function $n(n,t){Gn.point=Zn,Tn(kn=n,qn=t)}function Zn(n,t){var e=n-kn,r=t-qn,i=w(e*e+r*r);An+=i*(kn+n)/2,zn+=i*(qn+t)/2,Cn+=i,Tn(kn=n,qn=t)}function Bn(){Gn.point=Tn}function Dn(){Gn.point=Jn}function Hn(){Kn(_n,Nn)}function Jn(n,t){Gn.point=Kn,Tn(_n=kn=n,Nn=qn=t)}function Kn(n,t){var e=n-kn,r=t-qn,i=w(e*e+r*r);An+=i*(kn+n)/2,zn+=i*(qn+t)/2,Cn+=i,Fn+=(i=qn*n-kn*t)*(kn+n),On+=i*(qn+t),Rn+=3*i,Tn(kn=n,qn=t)}function Qn(n){this._context=n}Qn.prototype={_radius:4.5,pointRadius:function(n){return this._radius=n,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(n,t){switch(this._point){case 0:this._context.moveTo(n,t),this._point=1;break;case 1:this._context.lineTo(n,t);break;default:this._context.moveTo(n+this._radius,t),this._context.arc(n,t,this._radius,0,v)}},result:k};var Un,Vn,Wn,Xn,Yn,nt=a(),tt={point:k,lineStart:function(){tt.point=et},lineEnd:function(){Un&&rt(Vn,Wn),tt.point=k},polygonStart:function(){Un=!0},polygonEnd:function(){Un=null},result:function(){var n=+nt;return nt.reset(),n}};function et(n,t){tt.point=rt,Vn=Xn=n,Wn=Yn=t}function rt(n,t){Xn-=n,Yn-=t,nt.add(w(Xn*Xn+Yn*Yn)),Xn=n,Yn=t}function it(){this._string=[]}function ot(n){return"m0,"+n+"a"+n+","+n+" 0 1,1 0,"+-2*n+"a"+n+","+n+" 0 1,1 0,"+2*n+"z"}function ut(n,t){var e,r,i=4.5;function o(n){return n&&("function"==typeof i&&r.pointRadius(+i.apply(this,arguments)),z(n,e(r))),r.result()}return o.area=function(n){return z(n,e(dn)),dn.result()},o.measure=function(n){return z(n,e(tt)),tt.result()},o.bounds=function(n){return z(n,e(bn)),bn.result()},o.centroid=function(n){return z(n,e(Gn)),Gn.result()},o.projection=function(t){return arguments.length?(e=null==t?(n=null,an):(n=t).stream,o):n},o.context=function(n){return arguments.length?(r=null==n?(t=null,new it):new Qn(t=n),"function"!=typeof i&&r.pointRadius(i),o):t},o.pointRadius=function(n){return arguments.length?(i="function"==typeof n?n:(r.pointRadius(+n),+n),o):i},o.projection(n).context(t)}function at(n,t,e,r){return function(i,u){var a,l,c,f=t(u),s=i.invert(r[0],r[1]),p=U(),h=t(p),d=!1,v={point:g,lineStart:m,lineEnd:S,polygonStart:function(){v.point=E,v.lineStart=x,v.lineEnd=M,l=[],a=[]},polygonEnd:function(){v.point=g,v.lineStart=m,v.lineEnd=S,l=o(l);var n=un(a,s);l.length?(d||(u.polygonStart(),d=!0),Y(l,ct,n,e,u)):n&&(d||(u.polygonStart(),d=!0),u.lineStart(),e(null,null,1,u),u.lineEnd()),d&&(u.polygonEnd(),d=!1),l=a=null},sphere:function(){u.polygonStart(),u.lineStart(),e(null,null,1,u),u.lineEnd(),u.polygonEnd()}};function g(t,e){var r=i(t,e);n(t=r[0],e=r[1])&&u.point(t,e)}function y(n,t){var e=i(n,t);f.point(e[0],e[1])}function m(){v.point=y,f.lineStart()}function S(){v.point=g,f.lineEnd()}function E(n,t){c.push([n,t]);var e=i(n,t);h.point(e[0],e[1])}function x(){h.lineStart(),c=[]}function M(){E(c[0][0],c[0][1]),h.lineEnd();var n,t,e,r,i=h.clean(),o=p.result(),f=o.length;if(c.pop(),a.push(c),c=null,f)if(1&i){if((t=(e=o[0]).length-1)>0){for(d||(u.polygonStart(),d=!0),u.lineStart(),n=0;n<t;++n)u.point((r=e[n])[0],r[1]);u.lineEnd()}}else f>1&&2&i&&o.push(o.pop().concat(o.shift())),l.push(o.filter(lt))}return v}}function lt(n){return n.length>1}function ct(n,t){return((n=n.x)[0]<0?n[1]-h-s:h-n[1])-((t=t.x)[0]<0?t[1]-h-s:h-t[1])}it.prototype={_circle:ot(4.5),pointRadius:function(n){return this._circle=ot(n),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(n,t){switch(this._point){case 0:this._string.push("M",n,",",t),this._point=1;break;case 1:this._string.push("L",n,",",t);break;default:this._string.push("M",n,",",t,this._circle)}},result:function(){if(this._string.length){var n=this._string.join("");return this._string=[],n}}};var ft=at((function(){return!0}),st,ht,[-p,-h]);function st(n){var t,e=NaN,r=NaN,i=NaN;return{lineStart:function(){n.lineStart(),t=1},point:function(o,u){var a=o>0?p:-p,l=m(o-e);m(l-p)<s?(n.point(e,r=(r+u)/2>0?h:-h),n.point(i,r),n.lineEnd(),n.lineStart(),n.point(a,r),n.point(o,r),t=0):i!==a&&l>=p&&(m(e-i)<s&&(e-=i*s),m(o-a)<s&&(o-=a*s),r=pt(e,r,o,u),n.point(i,r),n.lineEnd(),n.lineStart(),n.point(a,r),t=0),n.point(e=o,r=u),i=a},lineEnd:function(){n.lineEnd(),e=r=NaN},clean:function(){return 2-t}}}function pt(n,t,e,r){var i,o,u=M(n-e);return m(u)>s?S((M(t)*(o=x(r))*M(e)-M(r)*(i=x(t))*M(n))/(i*o*u)):(t+r)/2}function ht(n,t,e,r){var i;if(null==n)i=e*h,r.point(-p,i),r.point(0,i),r.point(p,i),r.point(p,0),r.point(p,-i),r.point(0,-i),r.point(-p,-i),r.point(-p,0),r.point(-p,i);else if(m(n[0]-t[0])>s){var o=n[0]<t[0]?p:-p;i=e*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(t[0],t[1])}function dt(n,t){var e=x(n),r=e>0,i=m(e)>s;function o(e,r,i,o){K(o,n,t,i,e,r)}function u(n,t){return x(n)*x(t)>e}function a(n){var t,e,o,a,f;return{lineStart:function(){a=o=!1,f=1},point:function(h,d){var v,g=[h,d],y=u(h,d),m=r?y?0:c(h,d):y?c(h+(h<0?p:-p),d):0;if(!t&&(a=o=y)&&n.lineStart(),y!==o&&(v=l(t,g),(W(t,v)||W(g,v))&&(g[0]+=s,g[1]+=s,y=u(g[0],g[1]))),y!==o)f=0,y?(n.lineStart(),v=l(g,t),n.point(v[0],v[1])):(v=l(t,g),n.point(v[0],v[1]),n.lineEnd()),t=v;else if(i&&t&&r^y){var S;m&e||!(S=l(g,t,!0))||(f=0,r?(n.lineStart(),n.point(S[0][0],S[0][1]),n.point(S[1][0],S[1][1]),n.lineEnd()):(n.point(S[1][0],S[1][1]),n.lineEnd(),n.lineStart(),n.point(S[0][0],S[0][1])))}!y||t&&W(t,g)||n.point(g[0],g[1]),t=g,o=y,e=m},lineEnd:function(){o&&n.lineEnd(),t=null},clean:function(){return f|(a&&o)<<1}}}function l(n,t,r){var i=[1,0,0],o=R(F(n),F(t)),u=O(o,o),a=o[0],l=u-a*a;if(!l)return!r&&n;var c=e*u/l,f=-e*a/l,h=R(i,o),d=T(i,c);G(d,T(o,f));var v=h,g=O(d,v),y=O(v,v),S=g*g-y*(O(d,d)-1);if(!(S<0)){var E=w(S),x=T(v,(-g-E)/y);if(G(x,d),x=C(x),!r)return x;var M,b=n[0],_=t[0],N=n[1],k=t[1];_<b&&(M=b,b=_,_=M);var q=_-b,j=m(q-p)<s;if(!j&&k<N&&(M=N,N=k,k=M),j||q<s?j?N+k>0^x[1]<(m(x[0]-b)<s?N:k):N<=x[1]&&x[1]<=k:q>p^(b<=x[0]&&x[0]<=_)){var P=T(v,(-g+E)/y);return G(P,d),[x,C(P)]}}}function c(t,e){var i=r?n:p-n,o=0;return t<-i?o|=1:t>i&&(o|=2),e<-i?o|=4:e>i&&(o|=8),o}return at(u,a,o,r?[0,-n]:[-p,n-p])}function vt(n){return function(t){var e=new gt;for(var r in n)e[r]=n[r];return e.stream=t,e}}function gt(){}function yt(n,t,e){var r=t[1][0]-t[0][0],i=t[1][1]-t[0][1],o=n.clipExtent&&n.clipExtent();n.scale(150).translate([0,0]),null!=o&&n.clipExtent(null),z(e,n.stream(bn));var u=bn.result(),a=Math.min(r/(u[1][0]-u[0][0]),i/(u[1][1]-u[0][1])),l=+t[0][0]+(r-a*(u[1][0]+u[0][0]))/2,c=+t[0][1]+(i-a*(u[1][1]+u[0][1]))/2;return null!=o&&n.clipExtent(o),n.scale(150*a).translate([l,c])}function mt(n,t,e){return yt(n,[[0,0],t],e)}gt.prototype={constructor:gt,point:function(n,t){this.stream.point(n,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var St=16,Et=x(30*y);function xt(n,t){return+t?bt(n,t):Mt(n)}function Mt(n){return vt({point:function(t,e){t=n(t,e),this.stream.point(t[0],t[1])}})}function bt(n,t){function e(r,i,o,u,a,l,c,f,p,h,d,v,g,y){var S=c-r,x=f-i,M=S*S+x*x;if(M>4*t&&g--){var b=u+h,_=a+d,k=l+v,q=w(b*b+_*_+k*k),j=N(k/=q),P=m(m(k)-1)<s||m(o-p)<s?(o+p)/2:E(_,b),L=n(P,j),A=L[0],z=L[1],C=A-r,F=z-i,O=x*C-S*F;(O*O/M>t||m((S*C+x*F)/M-.5)>.3||u*h+a*d+l*v<Et)&&(e(r,i,o,u,a,l,A,z,P,b/=q,_/=q,k,g,y),y.point(A,z),e(A,z,P,b,_,k,c,f,p,h,d,v,g,y))}}return function(t){var r,i,o,u,a,l,c,f,s,p,h,d,v={point:g,lineStart:y,lineEnd:S,polygonStart:function(){t.polygonStart(),v.lineStart=E},polygonEnd:function(){t.polygonEnd(),v.lineStart=y}};function g(e,r){e=n(e,r),t.point(e[0],e[1])}function y(){f=NaN,v.point=m,t.lineStart()}function m(r,i){var o=F([r,i]),u=n(r,i);e(f,s,c,p,h,d,f=u[0],s=u[1],c=r,p=o[0],h=o[1],d=o[2],St,t),t.point(f,s)}function S(){v.point=g,t.lineEnd()}function E(){y(),v.point=x,v.lineEnd=M}function x(n,t){m(r=n,t),i=f,o=s,u=p,a=h,l=d,v.point=m}function M(){e(f,s,c,p,h,d,i,o,r,u,a,l,St,t),v.lineEnd=S,S()}return v}}var wt=vt({point:function(n,t){this.stream.point(n*y,t*y)}});function _t(n){var t,e,r,i,o,u,a,l,c,f,s=150,p=480,h=250,d=0,v=0,m=0,S=0,E=0,x=null,M=ft,b=null,_=an,N=.5,k=xt(P,N);function q(n){return[(n=o(n[0]*y,n[1]*y))[0]*s+e,r-n[1]*s]}function j(n){return(n=o.invert((n[0]-e)/s,(r-n[1])/s))&&[n[0]*g,n[1]*g]}function P(n,i){return[(n=t(n,i))[0]*s+e,r-n[1]*s]}function L(){o=$(i=B(m,S,E),t);var n=t(d,v);return e=p-n[0]*s,r=h+n[1]*s,A()}function A(){return c=f=null,q}return q.stream=function(n){return c&&f===n?c:c=wt(M(i,k(_(f=n))))},q.clipAngle=function(n){return arguments.length?(M=+n?dt(x=n*y,6*y):(x=null,ft),A()):x*g},q.clipExtent=function(n){return arguments.length?(_=null==n?(b=u=a=l=null,an):rn(b=+n[0][0],u=+n[0][1],a=+n[1][0],l=+n[1][1]),A()):null==b?null:[[b,u],[a,l]]},q.scale=function(n){return arguments.length?(s=+n,L()):s},q.translate=function(n){return arguments.length?(p=+n[0],h=+n[1],L()):[p,h]},q.center=function(n){return arguments.length?(d=n[0]%360*y,v=n[1]%360*y,L()):[d*g,v*g]},q.rotate=function(n){return arguments.length?(m=n[0]%360*y,S=n[1]%360*y,E=n.length>2?n[2]%360*y:0,L()):[m*g,S*g,E*g]},q.precision=function(n){return arguments.length?(k=xt(P,N=n*n),A()):w(N)},q.fitExtent=function(n,t){return yt(q,n,t)},q.fitSize=function(n,t){return mt(q,n,t)},function(){return t=n.apply(this,arguments),q.invert=t.invert&&j,L()}}function Nt(n){var t=0,e=p/3,r=_t(n),i=r(t,e);return i.parallels=function(n){return arguments.length?r(t=n[0]*y,e=n[1]*y):[t*g,e*g]},i}function kt(n){var t=x(n);function e(n,e){return[n*t,M(e)/t]}return e.invert=function(n,e){return[n/t,N(e*t)]},e}function qt(n,t){var e=M(n),r=(e+M(t))/2;if(m(r)<s)return kt(n);var i=1+e*(2*r-e),o=w(i)/r;function u(n,t){var e=w(i-2*r*M(t))/r;return[e*M(n*=r),o-e*x(n)]}return u.invert=function(n,t){var e=o-t;return[E(n,m(e))/r*b(e),N((i-(n*n+e*e)*r*r)/(2*r))]},u}function jt(){return Nt(qt).scale(155.424).center([0,33.6442])}function Pt(){return jt().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function Lt(n){return n}function At(n){if(null==n)return Lt;var t,e,r=n.scale[0],i=n.scale[1],o=n.translate[0],u=n.translate[1];return function(n,a){a||(t=e=0);var l=2,c=n.length,f=new Array(c);for(f[0]=(t+=n[0])*r+o,f[1]=(e+=n[1])*i+u;l<c;)f[l]=n[l],++l;return f}}function zt(n,t){for(var e,r=n.length,i=r-t;i<--r;)e=n[i],n[i++]=n[r],n[r]=e}function Ct(n,t){return"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map((function(t){return Ft(n,t)}))}:Ft(n,t)}function Ft(n,t){var e=t.id,r=t.bbox,i=null==t.properties?{}:t.properties,o=Ot(n,t);return null==e&&null==r?{type:"Feature",properties:i,geometry:o}:null==r?{type:"Feature",id:e,properties:i,geometry:o}:{type:"Feature",id:e,bbox:r,properties:i,geometry:o}}function Ot(n,t){var e=At(n.transform),r=n.arcs;function i(n,t){t.length&&t.pop();for(var i=r[n<0?~n:n],o=0,u=i.length;o<u;++o)t.push(e(i[o],o));n<0&&zt(t,u)}function o(n){return e(n)}function u(n){for(var t=[],e=0,r=n.length;e<r;++e)i(n[e],t);return t.length<2&&t.push(t[0]),t}function a(n){for(var t=u(n);t.length<4;)t.push(t[0]);return t}function l(n){return n.map(a)}function c(n){var t,e=n.type;switch(e){case"GeometryCollection":return{type:e,geometries:n.geometries.map(c)};case"Point":t=o(n.coordinates);break;case"MultiPoint":t=n.coordinates.map(o);break;case"LineString":t=u(n.arcs);break;case"MultiLineString":t=n.arcs.map(u);break;case"Polygon":t=l(n.arcs);break;case"MultiPolygon":t=n.arcs.map(l);break;default:return null}return{type:e,coordinates:t}}return c(t)}function Rt(n,t){return n(t={exports:{}},t.exports),t.exports}function Gt(){var n=8,t=Pt(),e=function(n){return{}},r=function(n){return 1};function i(i,c){i=l(i);for(var s,p,d,v=h(i.transform),g=i.arcs.length,y=0,m=new Array(g);y<g;){for(s=0,p=0,w=i.arcs[y].length,_=0,d=new Array(w);_<w;)i.arcs[y][_][0]=s+=i.arcs[y][_][0],i.arcs[y][_][1]=p+=i.arcs[y][_][1],d[_]=null===t?v(i.arcs[y][_]):t(v(i.arcs[y][_])),_++;m[y++]=d}var S=ut().projection(null),E=f(m,{type:"GeometryCollection",geometries:c}).geometries.map((function(n){return{type:"Feature",id:n.id,properties:e.call(null,n,i),geometry:n}})),x=E.map(r),M=u(x);if(n<=0)return E;for(var b=0;b++<n;){var w,_,N,k,q,j,P,L,A,z,C,F,O,R,G=E.map(S.area),T=u(G),I=0,$=0,Z=E.map((function(n,t){var e=Math.abs(G[t]),r=+x[t],i=T*r/M,o=Math.sqrt(e/Math.PI),u=Math.sqrt(i/Math.PI)-o,a=Math.max(e,i)/Math.min(e,i);return I+=a,$++,{id:n.id,area:e,centroid:S.centroid(n),value:r,desired:i,radius:o,mass:u,sizeError:a}})),B=I/$,D=1/(1+B);for(g=m.length,y=0;y<g;){for(w=m[y].length,_=0;_<w;){for(N=[0,0],k=Z.length,q=0;q<k;)j=Z[q].centroid,P=Z[q].mass,A=(L=Z[q].radius)*L,F=(z=m[y][_][0]-j[0])*z+(C=m[y][_][1]-j[1])*C,R=(O=Math.sqrt(F))>L?P*L/O:P*(F/A)*(4-3*O/L),N[0]+=R*o(C,z),N[1]+=R*a(C,z),q++;m[y][_][0]+=N[0]*D,m[y][_][1]+=N[1]*D,_++}y++}if(B<=1)break}return{features:E,arcs:m}}function o(n,t){if(0===t)return 0;var e=n/t;return t>0?1/Math.sqrt(1+e*e):-1/Math.sqrt(1+e*e)}function a(n,t){if(0===t)return 1;var e=n/t;return t>0?e/Math.sqrt(1+e*e):-e/Math.sqrt(1+e*e)}function l(n){return n instanceof Array?n.map(l):"string"==typeof n||"number"==typeof n?n:c(n)}function c(n){var t={};for(var e in n)t[e]=l(n[e]);return t}function f(n,t){function e(t,e){e.length&&e.pop();for(var r=n[t<0?~t:t],i=0,o=r.length;i<o;++i)e.push(r[i]);t<0&&s(e,o)}function r(n){for(var t=[],r=0,i=n.length;r<i;++r)e(n[r],t);return t}function i(n){return n.map(r)}function o(n){return(n=Object.create(n)).coordinates=u[n.type](n.arcs),n}var u={LineString:r,MultiLineString:i,Polygon:i,MultiPolygon:function(n){return n.map(i)}};return"GeometryCollection"===t.type?((t=Object.create(t)).geometries=t.geometries.map(o),t):o(t)}function s(n,t){for(var e,r=n.length,i=r-t;i<--r;)e=n[i],n[i++]=n[r],n[r]=e}function p(n){return function(){return n}}i.path=ut().projection(null),i.iterations=function(t){return arguments.length?(n=t,i):n},i.value=function(n){return arguments.length?(r="function"==typeof n?n:p(n),i):r},i.projection=function(n){return arguments.length?(t=n,i):t},i.feature=function(n,t){return{type:"Feature",id:t.id,properties:e.call(null,t,n),geometry:{type:t.type,coordinates:Ct(n,t).geometry.coordinates}}},i.features=function(n,t){return t.map((function(t){return i.feature(n,t)}))},i.properties=function(n){return arguments.length?(e="function"==typeof n?n:p(n),i):e};var h=i.transformer=function(n){var t=n.scale[0],e=n.scale[1],r=n.translate[0],i=n.translate[1];function o(n){return[n[0]*t+r,n[1]*e+i]}return o.invert=function(n){return[(n[0]-r)/t,(n[1]-i)/e]},o};return i}"undefined"!=typeof window?window:void 0!==n||"undefined"!=typeof self&&self,Rt((function(n,t){!function(t,e,r){n.exports=r()}(0,0,(function(){return function(t){var e=t instanceof Array?[]:{};return function t(e,r){for(var i in e){var o=e[i];o instanceof Array?t(o,n(r,i,[])):o instanceof Object&&"function"!=typeof o?t(o,n(r,i,{})):n(r,i,o)}}(t,e),e};function n(n,t,e){return n instanceof Array?(n.push(e),n[n.length-1]):n instanceof Object?(n[t]=e,n[t]):void 0}}))})),t.cartogram=Gt,Object.defineProperty(t,"__esModule",{value:!0})}(o),document.querySelector("#loader").classList.add("hide");let u=["#1abc9c","#2ecc71","#3498db","#9b59b6","#34495e","#16a085","#27ae60","#2980b9","#8e44ad","#2c3e50","#f1c40f","#e67e22","#e74c3c","#ecf0f1","#95a5a6","#f39c12","#d35400","#c0392b","#bdc3c7","#7f8c8d"],a=document.querySelector("input#radius"),l=document.querySelector("input#select-radius"),c=document.querySelector("input#year"),f=document.querySelector("input#select-year");l.addEventListener("click",(()=>{a=document.querySelector("input#radius"),document.querySelector("#loader").classList.remove("hide"),g()})),f.addEventListener("click",(()=>{c=document.querySelector("input#year"),document.querySelector("#loader").classList.remove("hide"),g()}));const s=15,p=15,h=10,d=1250-h-10,v=750-s-p;function g(){let n=a.value;const l=d3.json("https://raw.githubusercontent.com/addu390/population-cartogram/master/data/test2/topo.json"),f=d3.csv("https://raw.githubusercontent.com/addu390/population-cartogram/master/data/world-population-unpd-3.csv");Promise.all([l,f]).then((a=>{let[l,f]=a;!function(n,a,l,f){let g=1.5*l,w=d/g,_=Math.ceil(v/g),N=d3.range(_*w).map((function(n,t){return{x:Math.floor(t%w)*g,y:Math.floor(t/w)*g,datapoint:0}}));var k=function(n){var t={};for(var e in n)t[n[e].code]=n[e];return t}(a),q=o.cartogram().projection(null).properties((function(n){return n.properties})).value((function(n){return+n.properties.count}));q.features(n,n.objects.tiles.geometries);d3.scaleLinear().domain([1,1e9]).range([1,1e3]);q.value((function(n){return+k[n.properties.id][c.value]}));var j=q(n,n.objects.tiles.geometries).features;let P=[];for(let n=0;n<j.length;n++){var L=[];if("MultiPolygon"==j[n].geometry.type)for(let t=0;t<j[n].geometry.coordinates.length;t++)L[t]=j[n].geometry.coordinates[t][0];else"Polygon"==j[n].geometry.type&&(L[0]=j[n].geometry.coordinates[0]);P[n]={coordinates:L,properties:j[n].properties}}d3.select("#container").selectAll("*").remove();let A=function(){var n,o,u,a=0,l=0,c=1,f=1,s=r,p=i;function h(n){var t,e={},r=[],i=n.length;for(t=0;t<i;++t)if(!isNaN(l=+s.call(null,a=n[t],t,n))&&!isNaN(c=+p.call(null,a,t,n))){var a,l,c,f=Math.round(c/=u),h=Math.round(l=l/o-(1&f)/2),d=c-f;if(3*Math.abs(d)>1){var v=l-h,g=h+(l<h?-1:1)/2,y=f+(c<f?-1:1),m=l-g,S=c-y;v*v+d*d>m*m+S*S&&(h=g+(1&f?1:-1)/2,f=y)}var E=h+"-"+f,x=e[E];x?x.push(a):(r.push(x=e[E]=[a]),x.x=(h+(1&f)/2)*o,x.y=f*u)}return r}function d(n){var t=0,r=0;return e.map((function(e){var i=Math.sin(e)*n,o=-Math.cos(e)*n,u=i-t,a=o-r;return t=i,r=o,[u,a]}))}return h.hexagon=function(t){return"m"+d(null==t?n:+t).join("l")+"z"},h.centers=function(){for(var t=[],e=Math.round(l/u),r=Math.round(a/o),i=e*u;i<f+n;i+=u,++e)for(var s=r*o+(1&e)*o/2;s<c+o/2;s+=o)t.push([s,i]);return t},h.mesh=function(){var t=d(n).slice(0,4).join("l");return h.centers().map((function(n){return"M"+n+"m"+t})).join("")},h.x=function(n){return arguments.length?(s=n,h):s},h.y=function(n){return arguments.length?(p=n,h):p},h.radius=function(e){return arguments.length?(o=2*(n=+e)*Math.sin(t),u=1.5*n,h):n},h.size=function(n){return arguments.length?(a=l=0,c=+n[0],f=+n[1],h):[c-a,f-l]},h.extent=function(n){return arguments.length?(a=+n[0][0],l=+n[0][1],c=+n[1][0],f=+n[1][1],h):[[a,l],[c,f]]},h.radius(1)}().radius(l).x((function(n){return n.x})).y((function(n){return n.y}));const z=d3.select("#container").append("svg").attr("width",d+h+s).attr("height",v+s+p).append("g").attr("transform",`translate(${h} ${s})`);z.append("g").attr("id","hexes").selectAll(".hex").data(A(N)).enter().append("path").attr("class","hex").attr("transform",(function(n){return"translate("+n.x+", "+n.y+")"})).attr("d",A.hexagon()).style("fill","#fff").style("stroke","#e0e0e0").style("stroke-width",.5).on("click",m);for(let n=0;n<P.length;n++)for(let t=0;t<P[n].coordinates.length;t++){var C=P[n].coordinates[t];let e=A(N.reduce((function(n,t){return d3.polygonContains(C,[t.x,t.y])&&n.push(t),n}),[]));z.append("g").attr("id","hexes").selectAll(".hex").data(e).enter().append("path").attr("class","hex"+P[n].properties.id).attr("transform",(function(n){return"translate("+n.x+", "+n.y+")"})).attr("x",(function(n){return n.x})).attr("y",(function(n){return n.y})).attr("d",A.hexagon()).style("fill",u[n%19]).style("stroke","#000").style("stroke-width",.5).on("click",S).on("mouseover",y).on("mouseout",E).call(d3.drag().on("start",x).on("drag",M).on("end",b))}}(l,f,n),document.querySelector("#loader").classList.add("hide")}))}function y(n){d3.select(this).transition().duration(10).style("fill-opacity",.9)}function m(n){if("Remove"==document.querySelector("#label-option").value)d3.select(this).style("fill","#fff").style("stroke","#e0e0e0").style("stroke-width",.5).lower();else{let n=document.querySelector("#color-option");d3.select(this).style("stroke-width",.5).style("fill",n.value).style("stroke","#000").on("mouseover",y).on("mouseout",E).call(d3.drag().on("start",x).on("drag",M).on("end",b)).raise()}}function S(n){if("Remove"==document.querySelector("#label-option").value)d3.select(this).remove();else{let n=document.querySelector("#color-option");d3.select(this).style("stroke-width",.5).style("fill",n.value).style("stroke","#000").on("mouseover",y).on("mouseout",E).call(d3.drag().on("start",x).on("drag",M).on("end",b)).raise()}}function E(n){d3.select(this).transition().duration(10).style("fill-opacity",1)}function x(n,t){t.fixed=!1,d3.select(this).raise().style("stroke-width",1).style("stroke","#000")}function M(n,t){let e=a.value;var r=function(n,t,e){var r,i,o=Math.sqrt(3)/2,u=2*e,a=u*o,l=3*e;t%l<e?(i=t-t%l,r=n-n%a):(i=t+(u-e*o/2)-t%l,r=n+e*o-n%a);return[r,i]}(n.x,n.y,e);d3.select(this).attr("x",t.x=r[0]).attr("y",t.y=r[1]).attr("transform",(function(n){return"translate("+n.x+", "+n.y+")"}))}function b(n,t){t.fixed=!0,d3.select(this).style("stroke-width",.5).style("stroke","#000")}g();
//# sourceMappingURL=index.1e84af1a.js.map
