{"mappings":"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","sources":["node_modules/d3-hexbin/src/hexbin.js","app.js"],"sourcesContent":["var thirdPi = Math.PI / 3,\n    angles = [0, thirdPi, 2 * thirdPi, 3 * thirdPi, 4 * thirdPi, 5 * thirdPi];\n\nfunction pointX(d) {\n  return d[0];\n}\n\nfunction pointY(d) {\n  return d[1];\n}\n\nexport default function() {\n  var x0 = 0,\n      y0 = 0,\n      x1 = 1,\n      y1 = 1,\n      x = pointX,\n      y = pointY,\n      r,\n      dx,\n      dy;\n\n  function hexbin(points) {\n    var binsById = {}, bins = [], i, n = points.length;\n\n    for (i = 0; i < n; ++i) {\n      if (isNaN(px = +x.call(null, point = points[i], i, points))\n          || isNaN(py = +y.call(null, point, i, points))) continue;\n\n      var point,\n          px,\n          py,\n          pj = Math.round(py = py / dy),\n          pi = Math.round(px = px / dx - (pj & 1) / 2),\n          py1 = py - pj;\n\n      if (Math.abs(py1) * 3 > 1) {\n        var px1 = px - pi,\n            pi2 = pi + (px < pi ? -1 : 1) / 2,\n            pj2 = pj + (py < pj ? -1 : 1),\n            px2 = px - pi2,\n            py2 = py - pj2;\n        if (px1 * px1 + py1 * py1 > px2 * px2 + py2 * py2) pi = pi2 + (pj & 1 ? 1 : -1) / 2, pj = pj2;\n      }\n\n      var id = pi + \"-\" + pj, bin = binsById[id];\n      if (bin) bin.push(point);\n      else {\n        bins.push(bin = binsById[id] = [point]);\n        bin.x = (pi + (pj & 1) / 2) * dx;\n        bin.y = pj * dy;\n      }\n    }\n\n    return bins;\n  }\n\n  function hexagon(radius) {\n    var x0 = 0, y0 = 0;\n    return angles.map(function(angle) {\n      var x1 = Math.sin(angle) * radius,\n          y1 = -Math.cos(angle) * radius,\n          dx = x1 - x0,\n          dy = y1 - y0;\n      x0 = x1, y0 = y1;\n      return [dx, dy];\n    });\n  }\n\n  hexbin.hexagon = function(radius) {\n    return \"m\" + hexagon(radius == null ? r : +radius).join(\"l\") + \"z\";\n  };\n\n  hexbin.centers = function() {\n    var centers = [],\n        j = Math.round(y0 / dy),\n        i = Math.round(x0 / dx);\n    for (var y = j * dy; y < y1 + r; y += dy, ++j) {\n      for (var x = i * dx + (j & 1) * dx / 2; x < x1 + dx / 2; x += dx) {\n        centers.push([x, y]);\n      }\n    }\n    return centers;\n  };\n\n  hexbin.mesh = function() {\n    var fragment = hexagon(r).slice(0, 4).join(\"l\");\n    return hexbin.centers().map(function(p) { return \"M\" + p + \"m\" + fragment; }).join(\"\");\n  };\n\n  hexbin.x = function(_) {\n    return arguments.length ? (x = _, hexbin) : x;\n  };\n\n  hexbin.y = function(_) {\n    return arguments.length ? (y = _, hexbin) : y;\n  };\n\n  hexbin.radius = function(_) {\n    return arguments.length ? (r = +_, dx = r * 2 * Math.sin(thirdPi), dy = r * 1.5, hexbin) : r;\n  };\n\n  hexbin.size = function(_) {\n    return arguments.length ? (x0 = y0 = 0, x1 = +_[0], y1 = +_[1], hexbin) : [x1 - x0, y1 - y0];\n  };\n\n  hexbin.extent = function(_) {\n    return arguments.length ? (x0 = +_[0][0], y0 = +_[0][1], x1 = +_[1][0], y1 = +_[1][1], hexbin) : [[x0, y0], [x1, y1]];\n  };\n\n  return hexbin.radius(1);\n}\n","import { hexbin } from 'd3-hexbin'\n\nlet errorInputElement = document.querySelector('input#error');\n\nerrorInputElement.addEventListener('click', () => {\n  console.log(errorInputElement.value)\n  start()\n});\n\nfunction start() {\n  let hexRadius = errorInputElement.value\n  const geoData = d3.json(\n    'https://raw.githubusercontent.com/addu390/population-cartogram/master/data/population/2018/geo.json'\n  );\n  Promise.all([geoData]).then(res => {\n    let [geoData] = res;\n\n    plot_map(geoData, hexRadius);\n  });\n}\n\nfunction plot_map(geo, hexRadius) {\n\n  const margin = { top: 30, right: 30, bottom: 30, left: 30 },\n    width = 1250 - margin.left - margin.right,\n    height = 750 - margin.top - margin.bottom;\n\n  let hexDistance = hexRadius * 1.5\n  let cols = width / hexDistance\n\n  let new_projection = d3.geoNaturalEarth1().fitExtent([[0, height * 0.05], [width, height * 0.95]], geo)\n\n  let rows = Math.ceil(height / hexDistance);\n\n  let pointGrid = d3.range(rows * cols).map(function (el, i) {\n    return {\n      x: Math.floor(i % cols) * hexDistance,\n      y: Math.floor(i / cols) * hexDistance,\n      datapoint: 0\n    };\n  });\n\n  let features = []\n\n  for (let i = 0; i < geo.features.length; i++) {\n    features[i] = []\n    if (geo.features[i].geometry.type == \"MultiPolygon\") {\n      for (let j = 0; j < geo.features[i].geometry.coordinates.length; j++) {\n        features[i] = features[i].concat(geo.features[i].geometry.coordinates[j][0])\n      }\n    }\n\n    else if (geo.features[i].geometry.type == \"Polygon\") {\n      features[i] = features[i].concat(geo.features[i].geometry.coordinates[0])\n    }\n  }\n\n  d3.select('#container').selectAll(\"*\").remove()\n\n  let new_hexbin = hexbin()\n    .radius(hexRadius)\n    .x(function (d) { return d.x; })\n    .y(function (d) { return d.y; })\n\n  const svg = d3.select('#container')\n    .append('svg')\n    .attr('width', width + margin.left + margin.top)\n    .attr('height', height + margin.top + margin.bottom)\n    .append('g')\n    .attr('transform', `translate(${margin.left} ${margin.top})`);\n\n  svg.append('g').attr('id', 'hexes')\n    .selectAll('.hex')\n    .data(new_hexbin(pointGrid))\n    .enter().append('path')\n    .attr('class', 'hex')\n    .attr('transform', function (d) { return 'translate(' + d.x + ', ' + d.y + ')'; })\n    .attr('d', new_hexbin.hexagon())\n    .style('fill', '#fff')\n    .style('stroke', '#e0e0e0')\n    .style('stroke-width', 1);\n\n  let colors = ['#1abc9c', '#2ecc71', '#3498db', '#9b59b6', '#34495e', '#16a085', '#27ae60', '#2980b9', '#8e44ad', '#2c3e50',\n    '#f1c40f', '#e67e22', '#e74c3c', '#ecf0f1', '#95a5a6', '#f39c12', '#d35400', '#c0392b', '#bdc3c7', '#7f8c8d']\n\n  for (let i = 0; i < features.length; i++) {\n    let polygonPoints = features[i].map(el => new_projection(el));\n\n    let usPoints = pointGrid.reduce(function (arr, el) {\n      if (d3.polygonContains(polygonPoints, [el.x, el.y])) arr.push(el);\n      return arr;\n    }, [])\n\n    let hexPoints = new_hexbin(usPoints)\n\n    svg.append('g').attr('id', 'hexes')\n      .selectAll('.hex')\n      .data(hexPoints)\n      .enter().append('path')\n      .attr('class', 'hex')\n      .attr('transform', function (d) { return 'translate(' + d.x + ', ' + d.y + ')'; })\n      .attr('d', new_hexbin.hexagon())\n      .style('fill', colors[i % 19])\n      .style('stroke', '#000')\n      .style('stroke-width', 1)\n      .on(\"mouseover\", mover)\n      .on(\"mouseout\", mout);\n  }\n}\n\nfunction mover(d) {\n  var el = d3.select(this)\n    .transition()\n    .duration(10)\n    .style(\"fill-opacity\", 0.6);\n}\n\nfunction mout(d) {\n  var el = d3.select(this)\n    .transition()\n    .duration(1000)\n    .style(\"fill-opacity\", 1);\n}\n\nstart()"],"names":["$28bd4c13f05a9ff5$var$thirdPi","Math","PI","$28bd4c13f05a9ff5$var$angles","$28bd4c13f05a9ff5$var$pointX","d","$28bd4c13f05a9ff5$var$pointY","$6b17f08f738443dc$var$errorInputElement","document","querySelector","$6b17f08f738443dc$var$start","hexRadius","value","geoData1","d3","json","Promise","all","then","res","geoData","geo","margin","top","right","bottom","left","width","height","hexDistance","cols","new_projection","geoNaturalEarth1","fitExtent","rows","ceil","pointGrid","range","map","el","i","x","floor","y","datapoint","features","i2","length","geometry","type","j","coordinates","concat","select","selectAll","remove","new_hexbin","r","dx1","dy1","x01","y01","x11","y11","x2","y2","hexbin","points","binsById","bins","n","isNaN","px","call","point","py","pj","round","pi","py1","abs","px1","pi2","pj2","px2","py2","id","bin","push","hexagon","radius","x0","y0","angle","x1","sin","y1","cos","dx","dy","join","centers","mesh","fragment","slice","p","_","arguments","size","extent","$28bd4c13f05a9ff5$export$2e2bcd8739ae039","svg","append","attr","data","enter","style","colors","i1","polygonPoints","hexPoints","reduce","arr","polygonContains","on","$6b17f08f738443dc$var$mover","$6b17f08f738443dc$var$mout","$6b17f08f738443dc$var$plot_map","this","transition","duration","addEventListener","console","log"],"version":3,"file":"index.e268e7eb.js.map"}